package config

import (
	"fmt"
	"strings"
)

const (
	BYTE_SANDBOX  = "sandbox"
	BYTE_BOE      = "boe"
	BYTE_PROD_CN  = "prod-cn"
	BYTE_PROD_ROW = "prod-row"
)

var env = []string{BYTE_BOE, BYTE_PROD_CN, BYTE_PROD_ROW, BYTE_SANDBOX}

func GetByteZTIBundles() ([]byte, error) {
	all := []byte{}
	for _, e := range env {
		one, err := GetByteZTIBundle(e)
		if err != nil {
			return nil, err
		}

		all = append(all, one...)
		if !strings.HasSuffix(string(all), "\n") {
			all = append(all, []byte("\n")...)
		}
	}

	return all, nil
}

func GetByteZTIBundle(env string) ([]byte, error) {
	// If no trust bundle found from system, load the static bundle bytes
	switch strings.ToLower(env) {
	case BYTE_PROD_CN:
		return []byte(ROOT_CN), nil
	case BYTE_PROD_ROW:
		return []byte(ROOT_ROW), nil
	case BYTE_BOE:
		return []byte(ROOT_BOE), nil
	case BYTE_SANDBOX:
		return []byte(ROOT_SANDBOX), nil

	default:
		return nil, fmt.Errorf("found no root ca for trust domain %s", env)
	}
}

const (
	ROOT_SANDBOX = `-----BEGIN CERTIFICATE-----
MIICrTCCAjOgAwIBAgIUffMK7v31Yc8cBi0Ny5bBqQr7K94wCgYIKoZIzj0EAwMw
gZUxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1N
b3VudGFpbiBWaWV3MRIwEAYDVQQKEwlCeXRlRGFuY2UxETAPBgNVBAsTCFNlY3Vy
aXR5MTIwMAYDVQQDEylCeXRlRGFuY2UgU2FuZGJveCBQcm9kIFJvb3QgQ0EgLSAy
MDIwMDUxNTAeFw0yMDA1MTYwNjUwMDBaFw0zNTA1MTMwNjUwMDBaMIGVMQswCQYD
VQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNTW91bnRhaW4g
VmlldzESMBAGA1UEChMJQnl0ZURhbmNlMREwDwYDVQQLEwhTZWN1cml0eTEyMDAG
A1UEAxMpQnl0ZURhbmNlIFNhbmRib3ggUHJvZCBSb290IENBIC0gMjAyMDA1MTUw
djAQBgcqhkjOPQIBBgUrgQQAIgNiAATx4nNJNMTCDfNSzjSj9EZQ/QI0gs/MsAf7
x2CkaDjkgeVgJpl+nf2jD+wlssPRHYxYMcM20QChqXO+2Vl85sj2cs2iGdDgPAfz
WXUjf6S/F44+YTmIjzbc5L5gd69OSgujQjBAMA4GA1UdDwEB/wQEAwIBpjAPBgNV
HRMBAf8EBTADAQH/MB0GA1UdDgQWBBTFmy7FCHgmQT/klwhxFZPFYDcV2DAKBggq
hkjOPQQDAwNoADBlAjEAqHiOhGkoMHo0HI3bLvSd8SVmNpFonyUTwZhOpTSfqu0p
BRZn3I8PGfSWuyrczdw0AjARGiugKDZO+DF/LSIeNEDHy0H9zBmtksOcSLCWqpcJ
CUX35Zykh+sKJ39HPvZqI6I=
-----END CERTIFICATE-----
`
	ROOT_BOE = `-----BEGIN CERTIFICATE-----
MIICFTCCAbugAwIBAgIJAJsf7pejcMKOMAoGCCqGSM49BAMCMHgxCzAJBgNVBAYT
AkNOMRAwDgYDVQQIDAdCZWlqaW5nMRAwDgYDVQQHDAdCZWlqaW5nMRIwEAYDVQQK
DAlCeXRlRGFuY2UxETAPBgNVBAsMCFNlY3VyaXR5MR4wHAYDVQQDDBVCeXRlRGFu
Y2UgQk9FIFJvb3QgQ0EwHhcNMjAwMTE1MDYxMTQwWhcNMzAwMTEyMDYxMTQwWjB4
MQswCQYDVQQGEwJDTjEQMA4GA1UECAwHQmVpamluZzEQMA4GA1UEBwwHQmVpamlu
ZzESMBAGA1UECgwJQnl0ZURhbmNlMREwDwYDVQQLDAhTZWN1cml0eTEeMBwGA1UE
AwwVQnl0ZURhbmNlIEJPRSBSb290IENBMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcD
QgAEt7vuSAB6wA06oAs/4QMcJPDPnO9Q37ChhlM+mM4npIMgZFlG3nAS1yLIJRE8
H0r51EqrgSi0wdEu4Oi7fhrnmqMuMCwwHAYDVR0RBBUwE4YRc3BpZmZlOi8vYm9l
LXJvb3QwDAYDVR0TBAUwAwEB/zAKBggqhkjOPQQDAgNIADBFAiEA6cGKAOaXEwFM
lBsbaSW7PFQZZWkMZEC720JZnk7ris0CIBh6MPAHeKAMnnZblbUKxzRUwkiMfkx5
USKCyxvWPZpz
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIICsTCCAjegAwIBAgIUd6ip6QnqvZvYaKZYoU7gHFfS0+8wCgYIKoZIzj0EAwMw
gZcxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1N
b3VudGFpbiBWaWV3MRIwEAYDVQQKEwlCeXRlRGFuY2UxETAPBgNVBAsTCFNlY3Vy
aXR5MTQwMgYDVQQDEytCeXRlRGFuY2UgQk9FIFByb2R1Y3Rpb24gUm9vdCBDQSAt
IDIwMjAwMjI4MB4XDTIwMDIyOTAxMDIwMFoXDTI1MDIyNzAxMDIwMFowgZcxCzAJ
BgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1Nb3VudGFp
biBWaWV3MRIwEAYDVQQKEwlCeXRlRGFuY2UxETAPBgNVBAsTCFNlY3VyaXR5MTQw
MgYDVQQDEytCeXRlRGFuY2UgQk9FIFByb2R1Y3Rpb24gUm9vdCBDQSAtIDIwMjAw
MjI4MHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEExqMpZXIcUqHplLmJyp/1LYmkpR6
JDqiWHkUU85HLrRUKOLWXXaVayDFsVnmPqzs/CdWF7UqgM0swT95fqXx29gknLVf
ZX04iwJZsevmLx1eaCtXeZYDQ/x8Papjq3/no0IwQDAOBgNVHQ8BAf8EBAMCAaYw
DwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4EFgQUwN92aTy6jQ9z0reJ0KJQD4vxRDUw
CgYIKoZIzj0EAwMDaAAwZQIxAN5ZV85ljjAs9BPX56kpfwErlVyvAuaGeWfEhJJE
vowlD7d7GiDdJyAcs+BmPD8JZwIwHiEnJCwweh+GbqAl0MTp98MGBDEs3lOFeJc6
lqY0P98sjXNfpq3xsK+ViExzJy4/
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIICqzCCAjGgAwIBAgIUZchzF6JjhCko5vG5edtKMOfBnCYwCgYIKoZIzj0EAwMw
gZQxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1N
b3VudGFpbiBWaWV3MQ8wDQYDVQQKEwZUaWtUb2sxETAPBgNVBAsTCFNlY3VyaXR5
MTQwMgYDVQQDEytUaWtUb2sgQk9FVFRQIFByb2R1Y3Rpb24gUm9vdCBDQSAtIDIw
MjIwOTAyMB4XDTIyMDkwMzE3MzEwMFoXDTI3MDkwMjE3MzEwMFowgZQxCzAJBgNV
BAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1Nb3VudGFpbiBW
aWV3MQ8wDQYDVQQKEwZUaWtUb2sxETAPBgNVBAsTCFNlY3VyaXR5MTQwMgYDVQQD
EytUaWtUb2sgQk9FVFRQIFByb2R1Y3Rpb24gUm9vdCBDQSAtIDIwMjIwOTAyMHYw
EAYHKoZIzj0CAQYFK4EEACIDYgAEbpzZtpuAobRtAj8whLpaOa3XX8Y/qzNVaGIx
CuiBZKT9YceBPJQC4ela5eBqd3kJvqwaywE/zGxz31ImTw28E2LzeS9NNxnB0eYt
3jMwtyR4jJ6a3MqUYfXSuAUlGqkRo0IwQDAOBgNVHQ8BAf8EBAMCAaYwDwYDVR0T
AQH/BAUwAwEB/zAdBgNVHQ4EFgQUkXjVBFR5+/SxO/Ue0TwyuMmkdQUwCgYIKoZI
zj0EAwMDaAAwZQIxAOJQl757mHIiftv3zX5/wp12yhPciSM4MSvbJosQg3FNahd8
ONXjwhdBtaQ5YwH2qQIwaPT+WnVPnNH+k6GTNNdBhfM4gWU7s5/fZFeyT1bX14A9
TA7yyhEs9wSi1uKoQXAp
-----END CERTIFICATE-----
`
	ROOT_CN = `-----BEGIN CERTIFICATE-----
MIICnDCCAiOgAwIBAgIUZKp1cyrz/njg+jBQ1pwUdub5/9swCgYIKoZIzj0EAwMw
gY0xCzAJBgNVBAYTAkNOMRAwDgYDVQQIEwdCZWlqaW5nMRAwDgYDVQQHEwdCZWlq
aW5nMRIwEAYDVQQKEwlCeXRlRGFuY2UxETAPBgNVBAsTCFNlY3VyaXR5MTMwMQYD
VQQDEypCeXRlRGFuY2UgQ04gUHJvZHVjdGlvbiBSb290IENBIC0gMjAyMDAzMTEw
HhcNMjAwMzEyMDIxODAwWhcNMjUwMzExMDIxODAwWjCBjTELMAkGA1UEBhMCQ04x
EDAOBgNVBAgTB0JlaWppbmcxEDAOBgNVBAcTB0JlaWppbmcxEjAQBgNVBAoTCUJ5
dGVEYW5jZTERMA8GA1UECxMIU2VjdXJpdHkxMzAxBgNVBAMTKkJ5dGVEYW5jZSBD
TiBQcm9kdWN0aW9uIFJvb3QgQ0EgLSAyMDIwMDMxMTB2MBAGByqGSM49AgEGBSuB
BAAiA2IABDMAbz9uyKiU5EXbH6bemqMPGzAp2rUI6TDvJcs2nnJlnYLXIUKR0CEQ
C/CF/pP/MjV6q/uBWglKMggUkJlda4IjQOkAiQsoCFBtprTufl2uBQlkU/hQBiFp
aL6ZKB05oKNCMEAwDgYDVR0PAQH/BAQDAgGmMA8GA1UdEwEB/wQFMAMBAf8wHQYD
VR0OBBYEFMBDQVD+rcZh/fVM6sXs1u74UJiRMAoGCCqGSM49BAMDA2cAMGQCMDDk
dM1zc2LM39v4To8m824j65b4+yQFiLwOWgtOZNXgRRUQ8qHH3xyresB50xNaAwIw
UF4bBLidBG8Tlvv3BWlvLzu1ZnXGRhXXc3I9O/cZFPxsd9AEbkBEAf6AG1VOnOGi
-----END CERTIFICATE-----
`

	ROOT_CN_PAY = `-----BEGIN CERTIFICATE-----
MIICrjCCAjWgAwIBAgIUagOZycetJeQWsyKEiNsl9Vj94NowCgYIKoZIzj0EAwMw
gZYxCzAJBgNVBAYTAkNOMREwDwYDVQQIEwhaaGVqaWFuZzERMA8GA1UEBxMISGFu
Z1pob3UxEjAQBgNVBAoTCUJ5dGVEYW5jZTERMA8GA1UECxMIU2VjdXJpdHkxOjA4
BgNVBAMTMUJ5dGVEYW5jZSBDaGluYSBQYXkgUHJvZHVjdGlvbiBSb290IENBIC0g
MjAyMzAyMjAwHhcNMjMwMjIwMTQyNDAwWhcNMjgwMjE5MTQyNDAwWjCBljELMAkG
A1UEBhMCQ04xETAPBgNVBAgTCFpoZWppYW5nMREwDwYDVQQHEwhIYW5nWmhvdTES
MBAGA1UEChMJQnl0ZURhbmNlMREwDwYDVQQLEwhTZWN1cml0eTE6MDgGA1UEAxMx
Qnl0ZURhbmNlIENoaW5hIFBheSBQcm9kdWN0aW9uIFJvb3QgQ0EgLSAyMDIzMDIy
MDB2MBAGByqGSM49AgEGBSuBBAAiA2IABFk4e4/GLW3Frentt8vx01evNGpG11pq
77MpRFBNNlOMjQAUmLH8Iyu04pOi4u9UWwTsKqIf3S+Jb8TZZYLwvKAe26zZ0TRd
vtQJ6EbA13Os6YjKBgMjB26epo0P20dUi6NCMEAwDgYDVR0PAQH/BAQDAgGmMA8G
A1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFFTgkfv9fmCw3/TsVRBqC2miGsQZMAoG
CCqGSM49BAMDA2cAMGQCMEC05r/vGf9+hOAUyUdkVx+oM8ktNVxID5bA5loHzcq4
oIVDcBOBVtT5L97SUicq2AIwBdbU/yGFqEyQ8mjzF2eb8Z+TNWCzO5VtnuYKSnuC
1z+N0UmJavpXmsqboiAq+0Fa
-----END CERTIFICATE-----
`

	ROOT_ROW = `-----BEGIN CERTIFICATE-----
MIICsTCCAjegAwIBAgIUc+PFUBEPqToJqRZNH7CWKP+jpmIwCgYIKoZIzj0EAwMw
gZcxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1N
b3VudGFpbiBWaWV3MRIwEAYDVQQKEwlCeXRlRGFuY2UxETAPBgNVBAsTCFNlY3Vy
aXR5MTQwMgYDVQQDEytCeXRlRGFuY2UgUk9XIFByb2R1Y3Rpb24gUm9vdCBDQSAt
IDIwMjAwMzA2MB4XDTIwMDMwNjE5NTEwMFoXDTI1MDMwNTE5NTEwMFowgZcxCzAJ
BgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1Nb3VudGFp
biBWaWV3MRIwEAYDVQQKEwlCeXRlRGFuY2UxETAPBgNVBAsTCFNlY3VyaXR5MTQw
MgYDVQQDEytCeXRlRGFuY2UgUk9XIFByb2R1Y3Rpb24gUm9vdCBDQSAtIDIwMjAw
MzA2MHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEtSspWH1fo600p60e6hWk9Jgl24xF
crCOfIuvPwpyoRk/25cpvsNN7so0NZJ4fKvoOvFCWBz5+/9IMq4sXlkm4nlWOEHe
3La1utjuldBgKMl/pRt1KoeDL7p9j9iMA3r+o0IwQDAOBgNVHQ8BAf8EBAMCAaYw
DwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4EFgQUO+kfr0urjjwD3IadaOLaL/MqEkkw
CgYIKoZIzj0EAwMDaAAwZQIxAJ48VolRaerSfG8Vm3AL+MolTTxwMbmOt4+Hdnrq
QXEItNwR959GMTO8/AQg3B50hwIwf1vVaLPqZO1xHbiU8metufz/DN0uF4mpSZCl
UN1l3yt9T3VCL/0FGHNhzJN++c3R
-----END CERTIFICATE-----
`
	ROOT_USTTP = `-----BEGIN CERTIFICATE-----
MIICsTCCAjegAwIBAgIUMaBHtU2GGMot19ibHqTskoiTJjwwCgYIKoZIzj0EAwMw
gZcxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1N
b3VudGFpbiBWaWV3MRIwEAYDVQQKEwlCeXRlRGFuY2UxETAPBgNVBAsTCFNlY3Vy
aXR5MTQwMgYDVQQDEytCeXRlRGFuY2UgVFRQIFByb2R1Y3Rpb24gUm9vdCBDQSAt
IDIwMjEwNzAyMB4XDTIxMDcwMjIyMDYwMFoXDTI2MDcwMTIyMDYwMFowgZcxCzAJ
BgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1Nb3VudGFp
biBWaWV3MRIwEAYDVQQKEwlCeXRlRGFuY2UxETAPBgNVBAsTCFNlY3VyaXR5MTQw
MgYDVQQDEytCeXRlRGFuY2UgVFRQIFByb2R1Y3Rpb24gUm9vdCBDQSAtIDIwMjEw
NzAyMHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEOZWkiAlJuGgy0vYF+aowQasv3Xyb
8YuO8caUDi0pnLMApE1A7IYk17u2gRhr8HYmP1xwuxVaey/vrEvm7Zck5X1J49P4
Kpszh66Rk4V+mS5ROMKVdVj5QmgZe6sCgWQso0IwQDAOBgNVHQ8BAf8EBAMCAaYw
DwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4EFgQUQbhzrBgdbefgeYKOkBtoeciGoAIw
CgYIKoZIzj0EAwMDaAAwZQIxAKFIa7IzC7P/f7QkFHcC0JQUbsIwfpruJaaHThoP
gw9OWEEkP+1paQHxaz41/f6c3QIwUFqFwBr/amFMjaqy/vv182qts3QlANOAWssf
8hsNf7ISf5xTAiFz3PNjaNVeWKDl
-----END CERTIFICATE-----
`

	ROOT_EUTTP = `-----BEGIN CERTIFICATE-----
MIICmzCCAiGgAwIBAgIUJe5OPz9xehr/TKUQ5VoLBhg1zKUwCgYIKoZIzj0EAwMw
gYwxCzAJBgNVBAYTAlVLMQ8wDQYDVQQIEwZMb25kb24xDzANBgNVBAcTBkxvbmRv
bjEPMA0GA1UEChMGVGlrdG9rMREwDwYDVQQLEwhTZWN1cml0eTE3MDUGA1UEAxMu
Qnl0ZURhbmNlIEVVLVRUUCBQcm9kdWN0aW9uIFJvb3QgQ0EgLSAyMDIzMDYyMDAe
Fw0yMzA2MjAxOTA0MDBaFw0zMTEwMTgxMTA0MDBaMIGMMQswCQYDVQQGEwJVSzEP
MA0GA1UECBMGTG9uZG9uMQ8wDQYDVQQHEwZMb25kb24xDzANBgNVBAoTBlRpa3Rv
azERMA8GA1UECxMIU2VjdXJpdHkxNzA1BgNVBAMTLkJ5dGVEYW5jZSBFVS1UVFAg
UHJvZHVjdGlvbiBSb290IENBIC0gMjAyMzA2MjAwdjAQBgcqhkjOPQIBBgUrgQQA
IgNiAARK5jjxKmCSBE9WhtLPHQ/Ck2vDhZ17o5R26XivnHuTVRrvFzwZaomiNGZV
s2YMQnNwO3S5gAwmrgzbmjSp7qcuj55bQIiL13So5uqh7AWmjvUGIFUGfOr5FaR6
GAv0ShujQjBAMA4GA1UdDwEB/wQEAwIBpjAPBgNVHRMBAf8EBTADAQH/MB0GA1Ud
DgQWBBRW1WfpgilD4QbNjAzFcLhzRcahijAKBggqhkjOPQQDAwNoADBlAjEAg5ai
oMV0HIfknRSubA/anyOOiblrviKWfydwQhFlYRMEVkhBwA+tZWnJfwu5hBcnAjA1
ScjhtAr7pppNh+0Vy706XdQaXNpPKxDrMOIno/yP38ehpcYLBzDFtKo2sd7RVzc=
-----END CERTIFICATE-----`
)
